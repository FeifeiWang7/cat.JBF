Use ubuntu 10.04 32 bit image 
  
    wget http://old-releases.ubuntu.com/releases/10.04/ubuntu-10.04-desktop-i386.iso
    
Download kernel 2.6.31
  
    wget https://github.com/torvalds/linux/archive/v2.6.31.tar.gz
    
compile kernel

disable the mmap_min_addr protection.

    sudo echo "vm.mmap_min_addr = 0" >> /etc/sysctl.conf

Make it working

    sudo /sbin/sysctl -p

i_pipe can be considered as a field of i_node. 

In rdwr_open function, before enter the lock, the i_pipe may be set to NULL by free_pipe_info. And since i_node still exists, it could still enter the lock. Since i_pipe is NULL, when dereference it, the kernel will get to the fake i_pipe mapped at 0x0, which will trigger the escalate privilege function that change the uid and gid as root.

The escalate privilege function search the area to match string that is pre-set as gid and uid, and when find them, change them to root.
